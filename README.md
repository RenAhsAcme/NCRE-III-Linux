# 计算机三级 Linux 备考

## 计算机硬件常识

### 冯·诺依曼体系结构

- **运算器**：（传统 CPU 中央处理器组成其一）负责算数运算和逻辑运算，也叫算数逻辑单元（ALU）；

- **控制器**：（传统 CPU 中央处理器组成其二）负责指挥协调计算机各部分工作，从内存中取出指令并译码执行；

  > 现代 CPU 组成更加复杂，除了运算器和控制器（含控制单元 CU），还包含**寄存器组（Registers）**、**高速缓存（Cache，L1/L2/L3）**、**浮点运算核心（FPU）**等；在单核 CPU 中，这些组件集成在一个物理核心内，多核 CPU 则是将多个处理核心（它们有各自的运算器和控制器）集成在一个芯片上。

- **存储器**：存放指令和数据（内存）；

- **输入设备**：将信息送入计算机；

- **输出设备**：将计算机处理结果送出；

  以上可记为“五大部件”。

- **核心思想**：存储程序，即指令和数据以同等地位存放在同一存储器中，并按顺序执行。

## 计算机软件分类

- **系统软件**：控制和协调计算机硬件、支持应用软件开发和运行的软件集合，以下均属于系统软件：
  - **操作系统**：管理计算机硬件与软件资源，并为应用和应用程序提供服务接口的、最基础的软件系统，它直接运行在裸机之上，是对硬件的第一层扩充，是所有其它软件运行的平台和基石；
  - **数据库管理系统（DBMS）**；
  - **语言处理程序（编译器、解释器）**；
  - **系统实用工具（如磁盘清理、诊断程序）**；
  - **设备驱动程序**。
- **应用软件**：为满足用户特定需求、解决具体问题而设计的软件，例如办公软件、浏览器、游戏、图形处理软件等，它们运行在操作系统上；

## 操作系统功能、基本特征与进程状态

具有**五大管理**功能：

- **处理器管理（进程管理）**：管理调度CPU，实现进程创建、撤销、同步、通信等；

  > - **进程（Process）详解**
  >   - **定义**：进程是程序的一次执行过程，是系统进行资源分配和调度的独立单位；
  >   - **与程序的区别**：程序是静态的指令集合，而进程是动态的，包含了程序、数据以及执行上下文（如寄存器、堆栈等）；
  >   - **在多道程序环境中**，多个进程并发执行，操作系统负责为每个进程分配必要的资源（CPU 时间片、内存空间、文件句柄等），并确保它们之间的隔离和协调。
  > - **进程与线程（Thread）**
  >   - **进程**：是资源分配的基本单位，拥有独立的地址空间、文件描述符、信号处理器等，创建和销毁进程的开销较大；
  >   - **线程**：是 CPU 调度的基本单位（有时被称为轻量级进程（Lightweight Process）），一个进程可以包含多个线程，它们共享进程的资源（如内存），但各自有自己的程序计数器、栈和寄存器组，线程的创建、销毁和切换开销远小于进程。
  > - **多线程的优势**
  >   - **响应性**：如果一个线程被阻塞，同一进程中的其它线程仍可运行；
  >   - **资源共享**：线程间共享内存和资源，无需复杂的进程间通信（IPC）机制；
  >   - **经济性**：创建和切换线程的成本较低；
  >   - **可扩展性**：在多核 CPU 上，多个线程可以真正并行执行。

- **存储管理**：内存分配、回收以及实现虚拟内存；

- **设备管理**：管理I/O设备，完成I/O请求，提高CPU和I/O设备的利用率；

- **文件管理**：对信息资源进行管理，以文件的形式组织在外部存储器上，实现文件的存取、共享和保护；

- **用户接口**：为用户提供使用计算机的接口（GUI、Shell、系统调用）。

**四大特征**：

- **并发**：在同一时间间隔内，系统中有多个程序同时处于运行状态（宏观上同时，微观上交替执行），这是现代操作系统的最基本特征，正是这个特性，才产生了对资源共享、虚拟化技术以及程序执行异步的需求；
- **共享**：指系统中的资源（如 CPU、内存、文件）可供多个并发执行的进程共同使用，可分为互斥共享（如打印机）和同时访问（如只读文件），并发执行必然导致对资源的竞争和共享需求；
- **虚拟**：指通过某种技术将一个物理实体映射为多个逻辑上的对应物，如虚拟内存、虚拟处理器，为了实现更好的并发性和资源共享，才需要虚拟化技术来提升资源利用率；
- **异步**：又称“不确定性”，指在多道程序环境下，进程的执行不是一贯到底的，其推进速度不可预知，正是由于并发执行和资源共享，才导致了进程执行的异步性。

**五态模型**：

- **新建态（New）**：进程正在被创建；
- **运行态（Running）**：进程正在 CPU 上执行；
- **就绪态（Ready）**：进程已具备运行条件，获得了除 CPU 之外的所有必要资源，正在等待系统分配 CPU 时间片；
- **阻塞/等待态（Blocked/Waiting）**：进程因等待某个时间（如 I/O 完成、信号量、消息等）的发生而暂时无法运行；
- **终止态（Exit/Terminated）**：进程已结束运行，等待父进程回收资源。

**状态转换触发条件**：

- **Running to Ready**：当分配给进程的时间片用完，或更高优先级的进程变为就绪时，正在运行的进程会被剥夺 CPU，放回就绪队列；
- **Running to Blocked**：进程在执行过程中主动请求等待某个时间，如发起 I/O 操作、申请互斥锁未获成功等；
- **Ready to Running**：进程被进程调度器选中，分配了 CPU 时间片；
- **Blocked to Ready**：进程等待的时间已经发生（如 I/O 完成、获取到锁），被移回就绪队列。

## 软件相关概念

- **自由软件（Free Software）**

  它赋予用户四种基本自由：

  - 出于任何目的运行软件的自由；
  - 研究软件如何工作，并修改它以满足自己需求的自由（访问源代码是此前提）；
  - 重新发布软件拷贝的自由；
  - 向公众发布修改后版本的自由，从而使整个社区收益。

- **开源软件（Open Source Software）**：与自由软件在理念上略有不同，但实践中高度重叠，都强调源代码的可得性和修改、分发的自由。

  **GNU GPL 许可证**：Linux 内核采用 GPL 许可证，这是一份典型的自由软件许可证，它要求基于 GPL 软件修改和分发的衍生作品也必须以 GPL 发布（传染性）。

## 常用网络协议/服务

- **SSH 协议**：全称“Secure Shell”（安全外壳协议），旨在为不安全网络上的两台计算机之间提供加密的、安全的远程登录和命令执行服务，它通过对传输的数据进行加密和身份验证来防止攻击，默认使用 22 端口；
  
  > 它替代了不安全的 Telnet 协议（端口号 23）。
  >
  > 在 Linux 平台，若要使其它主机能够通过 SSH 连接到本机，需要先启动 sshd 服务（SSH 协议的服务端守护进程）。
  >
  > 它可以将其它网络端口的流量通过 SSH 安全隧道传输。
  
  - **基本连接命令**：`ssh [-p port] username@hostname`；
  - **身份认证方式**
    
    - **密码认证**：使用用户名和密码；
    - **密钥认证**：使用公钥/私钥对，需要将本地公钥（~/.ssh/id_rsa.pub）复制到服务器的 `~/.ssh/authorized_keys` 文件中。
  - **配置文件**
    
    - **客户端**：
      - `/etc/ssh/ssh_config`：配置 SSH 客户端的行为，如连接时使用的默认选项、主机别名、密钥文件等；
      - `~/.ssh/config`：保存常用主机的别名、端口、用户名等；
      - `~/.ssh/known_hosts`：存储已连接过服务器的主机密钥，用于验证服务器身份，防止中间人攻击）；
      - `~/.ssh/id_rsa`（或 `id_dsa`，`id_ed25519`）：客户端使用的私钥；
      - `~/.ssh/id_rsa.pub`：公钥，可以安全地复制到服务器的 `authorized_keys` 文件中。
    - **服务端**：
      - `/etc/ssh/sshd_config`：用于配置 SSH 服务端的参数（如禁止 root 登录、修改端口、禁用密码认证、是否允许空密码、是否允许公钥认证、允许登录的用户列表、最大认证尝试次数等）（注意文件名中带 `d`，代表 daemon，适用于服务端）；
      - `~/.ssh/authorized_keys`：存储被授权可以使用公钥登录当前用户账户的所有客户端的公钥，当客户端发起 SSH 连接并出示私钥时，服务器会检查该文件中有无匹配的公钥。
  - **相关命令**
    
    - `scp [options] SOURCES target`：全称“Secure Copy Protocol”（安全复制协议）；
    
      > 远程目标的语法通常是：
      >
      > `远程用户@远程主机:远程路径`
    
      **可用选项**
    
      - `-r`：递归复制，当 SOURCE 是目录时使用；
      - `-P PORT`：指定端口号。
    
    - `sftp`：基于 SSH 的安全文件传输（交互式）；
    
    - `ssh-keygen [options]`：生成 SSH 密钥对；
    
      - **可用选项**
        - `-t dsa | ecdsa | ecdsa-sk | ed25519 | ed25519-sk | rsa`：指定加密方式。
      - **生成的密钥文件**
        - **私钥**：`~/.ssh/id_rsa`；
        - **公钥**：`~/.ssh/id_rsa.pub`（分发给需要登录的服务器）。
    
    - `ssh-copy-id [options] [user@]hostname`：将公钥自动复制到远程服务器；
    
      该命令会将密钥追加到服务器的 `~/.ssh/authorized_keys` 文件中。
      
    - `service sshd start`/`systemctl start sshd`/`/etc/init.d/sshd start`：启动 SSH 服务。
  
- **FTP 协议**：全称“File Transfer Protocol”（文件传输协议），用于在计算机网络上的客户端和服务器之间传输文件，明文传输，所有内容都不加密，非常不安全，默认使用 20（数据连接），21（控制连接）端口，其安全版本是 FTPS（FTP over SSL，默认使用 990 端口）或 SFTP（SSH File Transfer Protocol，默认使用与 SSH 相同的端口）；

- **HTTP 协议**：超文本传输协议，明文传输，用于 Web 通信，默认使用 80 端口，代理或备用端口为 8080，其安全版本是 HTTPS（HTTP over SSL/TLS），默认使用 443 端口；

- **ICMP 协议**：互联网控制消息协议，用于网络诊断和错误报告，不提供任何加密或安全服务，且常被用于如洪水攻击等网络攻击；

- **ARP 协议**：全称“Address Resolution Protocol”（地址解析协议），用于将 IP 地址映射到 MAC 地址。

  当主机需要与同一局域网内的另一台主机通信时，它会先查询 ARP 缓存，如果没有对应的 MAC 地址，就会广播一个 ARP 请求包，目标主机收到后会回复其 MAC 地址；

  - **基本用法**：`arp [options]`；
    - **可用选项**
      - `-a`：显示当前 ARP 缓存中的所有条目；
      - `-d <host>`：删除指定 IP 的 ARP 缓存目录；
      - `-s <host> <hwaddr>`：静态添加一条 ARP 记录（将 IP 绑定到指定 MAC）。

- **DHCP 协议**：全称“Dynamic Host Configuration Protocol”（动态主机配置协议），用于自动为网络中的设备分配 IP 地址等配置信息；

  - **工作过程（DORA）**
    - **发现（Discover）**：客户端广播寻找 DHCP 服务器；
    - **提供（Offer）**：服务器响应，提供一个可用的 IP 地址；
    - **选择（Request）**：客户端选择一个 IP 地址并通知服务器；
    - **确认（Acknowledge）**：服务器确认分配，并发送其它配置信息（子网掩码、网关、DNS 等）。
  - **端口**：服务器使用 UDP 67 端口，客户端使用 UDP 68 端口。
  - **相关概念**
    - **静态 IP**：手动配置的固定 IP 地址；
    - **IP 地址租约**：DHCP 分配的 IP 地址是有有效期的，到期后需要重新续约或重新分配；
    - **DHCP 中继**：用于在多个子网间转发 DHCP 广播请求。

- **SMTP 协议**：用于发送邮件，默认使用 25 端口；

- **POP3 协议**：用于接收邮件，默认使用 110 端口；

- **IMAP 协议**：用于接收邮件，默认使用 143 端口；

- **请求 - 响应**：一种通用的通信模式，不是某个特定协议；

- **DNS（域名系统）服务**：这里涉及的是非加密 DNS。

  - **默认端口**：53；
  - **查询方式**
    - **UDP 53**：用于大多数标准查询（如域名解析），UDP 是 DNS 查询的主要协议，因为它速度快、开销小；
    - **TCP 53**：用于区域传输（Zone Transfer，主从 DNS 服务器之间同步数据）以及当响应数据量过大（超过 512 字节）导致 UDP 包被截断时的 Fallback 协议。

  > 补充一些端口号：
  >
  > - MySQL 使用 3306 端口；
  > - PostgreSQL 使用 5432 端口；
  > - Redis 使用 6379 端口。

## 常用软件开发框架

- **Java 体系**
  - **Java Web 框架**
    - **Spring**：Java 企业级应用开发框架，其核心模块 Spring MVC 是一个典型的 Web 框架，用于构建基于 MVC 设计的 Web 应用程序；
    - **Struts2**：专门用于简化基于 Java 的 Web 应用开发；
  - **MyBatis**：Java 持久层框架，封装了 JDBC 操作，是数据库交互更加简便，常与 Web 框架集成使用，构成 Web 应用的后端技术栈
  - **JSF**
  - **Play Framework**
- **Python 体系**：Django、Flask、Tornado；
- **JavaScript/Node.js 体系**：Express.js、Koa、NestJS；
- **PHP 体系**：Laravel、ThinkPHP、Yii；
- **Ruby 体系**：Ruby on Rails；
- **游戏开发引擎**
  - **Unity**：跨平台游戏开发引擎，主要用于 2D/3D 视频游戏、模拟和交互式内容；
  - **Unreal Engine**（虚幻引擎）；
  - **Cocos2d-x**；
  - **Godot**。

## Web 服务器相关

**开源 Web 服务器**

- **Apache**：官方名称 Apache HTTP Server，由 Apache 软件基金会开发维护，是一个开源、跨平台的 Web 服务器软件，接收客户端的 HTTP 请求，并返回相应网页或数据，可用于托管网站、提供静态内容、或与后端应用服务器（如 PHP、Python、Java）结合提供动态内容；
- **Nginx**：由 Igor Sysoev 创建，现在由 Nginx, Inc. 公司维护，其核心版本是开源的，有商业版本 Nginx Plus；
- **Tomcat**：由 Apache 软件基金会开发维护，用于运行 Java Servlet 和 JSP，通常作为 Web 应用服务器（可处理动态内容）；

**非开源 Web 服务器**

- **IIS**：全称“Internet Information Services”，是微软公司开发并包含在其 Windows Server 操作系统中的专有 Web 服务器软件，不是开源的。

## MVC 设计模式

- **M（Model）**：模型，负责处理数据逻辑，如与数据库交互、数据验证、业务规则等，不关心用户界面；
- **V（View）**：视图，负责展示数据，即用户界面（UI）。它从模型获取数据，并决定如何呈现给用户；
- **C（Controller）**：控制器，负责处理用户输入和请求，它接收用户的输入，调用模型处理数据，并选择合适的视图来显示结果，它是模型和视图之间的桥梁。

MVC 具有以下工作流程：

- 用户通过视图发起请求（如输入 URL）；
- 控制器接收请求，并决定需要哪些模型和数据；
- 控制器调用相应的模型来处理业务逻辑和获取数据；
- 控制器将处理后的数据传递给视图；
- 视图将数据呈现给用户。

因此，该模型是理解许多 Web 框架的基础。

## Linux/Unix 哲学核心思想

**一切皆文件**

- **含义**：在 Linux 中，不仅仅是普通文件，还包括硬件设备、管道、套接字、进程信息、系统配置等，都以文件的形式呈现；
- **实现方式**：这些资源在 `/dev`、`/proc`、`/sys` 等虚拟文件系统中都有对应的文件节点，应用程序可以使用标准的文件操作 API 来与这些资源交互；
- **优势**：提供了统一的、简单的接口，使得用户空间程序可以像操作普通文件一样操作各种设备和内核对象，极大地简化了系统编程和设计。

## Linux 家族归属

因其开源、免费、高度可定制、稳定、安全、对资源要求低、社区支持强大，Linux 在 Web 服务器、数据库服务器、云基础设施中占绝对主导地位；Linux 在嵌入式系统中应用极广，如 Android（基于 Linux 内核）、路由器、物联网设备等；Linux 几乎覆盖了全球顶级的超级计算机，在高性能计算和集群领域占据统治地位；

因其软件生态支持不足，硬件厂商驱动支持问题、普通用户习惯等因素，Linux 在桌面应用支持少。

### Linux Distribution

都基于 Linux 内核，包含 GNU 工具、库、附加软件和包管理系统。

- **Debian**：以稳定性和庞大软件仓库著称的 Linux 发行版，是Ubuntu 根基；

  - **Ubuntu**：基于 Debian，由 Canonical 公司支持，主要用于桌面和服务器；
  - **Mint**。

- **RedHat**：通常指 RHEL，主要用于企业，提供付费支持和服务；

  - **Fedora**：由 Red Hat 赞助的社区版 Linux 发行版，以采用新技术快而闻名，是 RHEL 的上游社区版；

  - **CentOS**：曾经基于 Red Hat Enterprise Linux（RHEL）源代码编译而成的社区免费版，主要用于企业。

    > CentOS 8 之后转型为 CentOS Stream，定位有所变化。

- **openSUSE**；

- **Arch Linux**；

- **Alpine Linux**；

- **Gentoo**：一个高度可定制、面向高级用户的 Linux 发行版，采用源代码包管理。

### 不属于 Linux Distribution

- **Solaris**：是 Oracle 公司的专有 Unix 操作系统。基于 SunOS 内核，源自 BSD Unix 和 System V Unix；

  > 混淆点在于它遵循了 POSIX 标准，命令行语法与 Linux 相似，但 Solaris 是独立的操作系统体系。

- **FreeBSD/OpenBSD**：属于 BSD Unix 家族；

- **AIX**（IBM Unix）；

- **HP-UX**（HP Unix）；

- **Windows**；

- **macOS**：基于 Darwin/BSD。

### Linux 和 Unix 的区别

Linux 是“类 Unix”系统，模仿了 Unix 的功能和接口， 但 Linux 内核是独立从头编写的，并非是由原始的 AT&T Unix 代码派生。而 Solaris、AIX、HP-UX 是传统的商业 Unix。

## Linux 相关命令

**提示：**理解 SYNOPSIS 的语法

- `[ ]` 方括号表示**可选**。
- `|` 竖线表示“或”。
- `...` 省略号表示可重复。
- `< >` 尖括号表示需要替换的占位符（如 `<文件名>`）。
- **大写单词**（如 `FILE`, `COMMAND`）通常也表示占位符。

### 用户操作

- `passwd [options] [LOGIN]`：修改用户账户密码；

  **可用选项**

  - `-l` 锁定账户；
  - `-u` 解锁账户；
  - `-S` 查看状态。

  > Q：为什么 `passwd` 命令有权限区分（即普通用户只能修改自己的密码，而 root 用户可以修改任意用户的密码）？
  >
  > A：`passwd` 命令修改的密码信息存储在 `/etc/shadow` 文件中，该文件只有 root 用户可写，普通用户修改密码时，调用的是 `/usr/bin/passwd` 完成，该程序会临时获得 root 权限，这是通过设置 SUID 权限实现的，从而写入 `/etc/shadow`。

- `pwd`：全称“print working directory”，显示当前工作目录的路径；

- `useradd [options] LOGIN`：添加新用户；

  - **执行操作**
    - 在 `/etc/passwd`、`/etc/shadow`、`/etc/group` 等文件中添加用户记录；
    - 默认在 `/home` 创建以用户名命名的家目录；
    - 将 `/etc/skel` 目录下的骨架文件（如 `.bashrc`、`.profile` 等默认配置文件）复制到新用户的家目录中。

  - **可用选项**
    - `-m`：创建家目录；
    - `-g GROUP`：指定主要组；
    - `-G GROUP`：指定附属组；
    - `-s SHELL`：指定登录 Shell；
    - `-c COMMENT`：指定用户的描述信息（Comment），如全名;
    - `-u UID`：指定用户的 UID；
    - `-d HOME_DIR`：指定用户的家目录路径。

- `usermod [options] LOGIN`：修改用户属性（如用户组、家目录、Shell等）；

  **可用选项**

  - `-g GROUP`：指定主要组；
  - `-G GROUPS`：指定附属组，若要不覆盖之前已有设置，使用 `-aG` 选项。

- `userdel [options] LOGIN`：删除用户；

  - **可用选项**

    - `-r`**（或** `--remove`**）**：要求同时删除该用户的家目录（`/home/username`）和邮件池（`/var/mail/username`），若未指定，则仅删除 `/etc/passwd`、`/etc/shadow`、`/etc/group` 等文件中的用户记录。

    > 该命令通常需要提权，且不能针对已登录用户操作。

> 备注：`useradd`，`userdel` 是 Linux 家族中更通用的用法。`deluser`，`adduser` 这种动词在前的一般是特定系统（如 Debian 及其衍生系统等）实现的前端工具，不具备普适性。

- `groups [options] [usernames]`：查看用户所属组；
- `id [options] [users]`：查看用户所属组；
- `groupadd [options] GROUP`：创建新的用户组；
- `w [options] [user]`：显示当前已登录系统的用户以及他们正在执行的进程。
  - **可用选项**
    - `-s`：使用短格式（不显示 JCPU 和 PCPU 时间，以及 LOGIN@ 时间）；
    - `-h`：不显示标题行。
  - **输出字段**：USER，TTY，FROM，LOGIN@，IDLE，JCPU，PCPU，WHAT。

### 文件操作

- `cd [dir]`：更改当前工作目录；
  
  - `cd` 或 `cd~`：切换到当前用户的家目录；
  - `cd -`：切换到上一个工作目录（基于历史记录）；
  - `cd ..` ：切换到上一级目录；
  - `cd /path/to/directory`：切换到指定的绝对路径。
  
- `cd relative/path`：切换到指定的相对路径；
  
- `ls [options] [files]`：列出对象内容；

  **可用选项**

  - `-l` 详情；

    - 当作用对象为文件时：

      该输出具有7个字段：

      **文件类型和权限**、**硬链接数**、**所有者**、**所属组**、**大小**、**最后修改时间 mtime**、**文件名**

      第一个字段的第一个字符是**文件类型标识符**：

      - `-`：普通文件；

        > 普通文件可根据自身内容的编码和用途，分为两大类：
        >
        > - **文本文件（Text/ASCII）**：内容由可打印的字符构成；
        > - **二进制文件（Binary）**：内容由机器码或特定格式的数据组成，通常不可直接阅读。

      - `d`：目录；

      - `l`：符号链接（软链接）文件；
        
        > - 它的权限位通常失效（`rwxr--r--`），真实权限由它指向的源文件决定；
        > - 它所对应的大小是链接本身路径名的长度，和源文件的大小无关；
        > - 文件名部分通常会显示为类似 `cheng -> /path/to/target` 的形式。

      - `c`：字符设备文件；
      - `b`：块设备文件；
      - `p`：命名管道；
      - `s`：套接字。

    - 当作用对象为设备时：

      可看到两个数字，如 `8, 0`，分别表示主设备号（标识设备驱动程序）和次设备号（标识该驱动程序管理的具体设备实例）；
      
    - `-lu`：显示访问时间 atime；

    - `-lc`：显示 inode 状态改变时间 ctime。

  - `-a` 显示所有文件，包括隐藏文件和 `.` 和 `..`；

  - `-A` 显示所有文件，包括隐藏文件，但不包括 `.` 和 `..`；

  - `-h` 人性化文件大小；

  - `-i` 查看文件 inode 号；

  - `-r` 反向排序列出目录内容。

- `mkdir [options] DIRECTORIES`：创建目录；

  **可用选项**

  - `-p`：表示“parents”，即如果目录路径中的上级目录不存在，则一并创建，且不报错。

- `rmdir [options] DIRECTORIES`：删除空目录；

  **可用选项**：

  - `-p`：删除指定目录后，若父目录变为空目录，则一并删除父目录。

- `rm [options] [files]`：删除；

  **可用选项**

  - `-r`/`-R`：递归删除目录及其所有内容；
  - `-f`：强制删除，忽略不存在的文件，不提示确认。

- `cp [options] SOURCES DIRECTORIES`：复制；

- `mv [options] SOURCES DIRECTORIES`：移动或重命名；

  **可用选项**

  - `-i`：危险操作前进行交互式确认。

  > `mv` 操作的是文件系统的目录项（文件名），而不是文件数据，因此在同一文件系统内移动或重命名非常快。

- `cat [options] [files]`：将（多个）文件内容重定向到标准输出（允许自定义重定向）；

- `tac [options] [files]`：读取并反向输出（从最后一行到第一行）指定文件的内容；

- `touch [options] FILES` 或 `> text`：创建空文件/覆盖文件；

- `tree`：以树状图列出目录的内容；

- `stat <file>`：查看文件的详细 inode 信息；

- `ln -s <file1> <file2>`：创建一个指向源文件 `<file1>` 的软链接 `<file2>`；

  若无 `-s` 选项，则创建硬链接。

- `sort [options] [files]`：对指定内容进行排序；

  **可用选项**：

  - `-t SEP`：指定 `SEP` 作为字段分隔符；
  - `-k KEYDEF`：指定 `KEYDEF` 作为排序键；
  - `-n `：进行数字排序；
  - `-c`：检查文件是否已排序，不做排序工作；
  - `-r`：反向排序；
  - `-u`：去重排序，输出唯一的行；
  - `-f`：忽略大小写；
  - `-o FILE`：将排序结果输出到 `FILE`。

- `grep [options] PATTERNS [files]`：在文件中搜索指定的模式；

  **可用选项**

  - `-i`：忽略大小写；
  - `-v`：反向选择，输出不匹配的行；
  - `-n`：显示匹配行及其行号；
  - `-E`：使用扩展正则表达式；
  - `-r`：递归在目录中搜索；
  - `-c`：统计匹配行的数量。

- `wc [options] [files]`：对输入进行计数；

  **可用选项**

  - `-l`：行数；
  - `-w`：单词数；
  - `-c`：字节数；
  - `-m`：字符数（与 `-c` 在 ASCII 文本中通常相同）。

- `find [options] [paths] [expression]`：在目录树中基于文件名、属性等查找文件；

  **可用表达式**

  - `-name PATTERN`：按给定的 PATTERN 匹配文件名，允许通配符；
  - `-type TYPE`：按给定的 TYPE 匹配文件类型，可使用的文件类型见 `ls` 部分（对于普通文件，是为 `f`）；
  - `-mtime N`：匹配最近 N 天内修改过的文件；
  - `-delete`：对匹配结果执行删除动作。

- `fold [options] [files]`：文本处理工具，用于限制文本行的宽度，将长行折叠成短行；

  **可用选项**

  - `-w WIDTH`：默认值 80，当使用该选项时，可以手动指定文本行的宽度。

- `join [options] FILE1 FILE2`：用于基于两个文件的公共字段合并两个已排序文件的行；

- `tr [options] STRING1 [STRING2]`：用于字符的转换、删除或压缩。

  **可用选项**

  - `-d`：指定删除操作。

- `gzip [options] [files]`：文件压缩指令；

- `tar [options] [files]`：文件压缩指令；

- `dd OPTION`：数据转换与复制的低级工具，可以从标准输入或文件中读取数据，按照指定格式转换，再输出到文件、设备或标准输出；

- `tail [options] [files]`：通用文件查看命令，用于输出文件的末尾部分（默认后 10 行）；

  **可用选项**

  - `-n NUM`：显示最后 NUM 行，；
  - `-f`：实时追踪文件末尾的新增内容（常用于查看日志）；
  - `-F`：类似 `-f`，但会追踪文件名变化（如日志轮转后）。

- `head`：显示文件的开头部分（默认前 10 行）；

- `multitail [options]`：同时追踪多个文件末尾部分；

- `nl [options] [files]`：给文件添加行号并输出；

- `awk [options] FILES`：一个强大的文本处理语言，可进行模式扫描和处理，主要用于提取和操作数据；

- `cut`：从文件的每一行中提取指定的字段或字符，是列提取工具。

### 进程操作

- `who [options] [files | args]`：显示当前登录到系统上的用户信息；

  **可用选项**

  `-l`：显示系统最后一次启动的时间。

- `ps [options]`：查看当前系统的进程状态；

  - **选项风格**

    - **Unix 风格**：选项前加 `-`；
    - **BSD 风格**：选项前无 `-`；
    - **GNU 长选项**：选项前加 `--`。

  - **可用选项**

    - `a`：显示所有用户的进程；

    - `u`：以用户为主的的详细格式；

    - `x`：包括没有控制终端的进程（如守护进程）；

    - `-e`/`-A`：显示所有进程；

    - `-f`：显示完整格式信息；

    - `-l`：长格式显示；

      其中 `NI` 列显示的是进程的 nice 值。

    - `-a`：显示所有终端上的进程（但不包括无控制终端的守护进程）；

    - `--forest`：用树形结构显示进程父子关系。

      > `ps aux` 和 `ps -ef` 的输出效果类似，但格式不同，例如 `ps aux` 有 %CPU 和 %MEM 列。
    
  - `STAT` **列常见状态代码**：

    - **R（Running）**：进程正在运行或在运行队列中等待；

    - **S（Sleeping）**：进程在可中断的睡眠状态（等待某个事件完成，如 I/O）；

    - **D（Disk Sleep）**：进程在不可中断的睡眠状态（通常是在等待 I/O，不能被信号唤醒）；

    - **T（Stopped）**：进程被停止（如由作业控制信号或调试器暂停）；

    - **Z（Zombie）**：僵死进程，进程已终止，但父进程尚未回收它（读取其退出状态），进程描述符仍保留在系统中。

      > - **产生原因**：子进程终止后，会向父进程发送 `SIGCHLD` 信号，如果父进程没有调用 `wait()` 或 `waitpid()` 来获取子进程的终止状态，那么子进程的进程描述符就不会被释放，成为僵死进程；
      > - **影响**：僵死进程本身不消耗资源，但会占用一个 PID，如果大量产生且不回收，可能会耗尽 PID 资源。

- `kill [-s sigspec | -n signum] PID`：按照 PID 终止进程；

  **信号**

  - `TERM`（15）：默认信号，通告进程终止，允许进程进行清理工作；
  - `KILL`（9）：强制立即终止进程，进程无法捕获或忽略此信号，可能造成数据丢失或状态不一致，应作为最后手段使用；
  - `HUP`（1）：挂起信号，常用来让守护进程重新读取配置文件。

- `killall [options] NAMES`：按照进程名终止进程；

  **可用选项**

  - `-u USER`/`--user USER`：终止指定用户的所有进程。

  > **`skill [signal] [options] <EXPRESSION>`**：**向进程发送信号**，功能与 `kill` 类似，现代系统上可能默认不安装，通常优先选择更常见、更标准的 **`killall`**。

- `nice [option] [commands]`：在启动进程时为其设置一个初始的“谦让值”，进而设置优先级；

- `renice [-n PRIORITY] [-p PID]`/`renice [-n PRIORITY] [-u USER]`：调整某个正在运行的进程的优先级；

  **进程优先级**：-20 - 19

  - **值的范围**：值越低，优先级越高；反之亦反（记忆：谦让值，越大越谦让。）；
  - **默认值**：普通用户启动的进程默认 nice 值为 0，普通用户只能提高自己进程的 nice 值（0 → 正数）；root 权限可以在范围内任意设定。
  
  > **Priority** 和 **Nice** 详解：
  >
  > **Priority（PRI）**：内核实际用来调度进程的动态优先级，它的计算与 Nice 值有关，但会受到内核动态调整的影响，用户不能直接修改 PRI；
  >
  > **Nice（NI）**：用户可修改的静态优先级，用于影响进程的“谦让度”（niceness）。
  
- `pgrep [options] <pattern>`：根据进程名查找 PID；

> 系统的第一个进程是 `init`，其PID 为 1。

- `top [options]`：交互式动态进程查看器，它实时更新显示系统概况和进程列表（PID、用户、CPU%、内存%、命令等），可以按照各种指标对进程进行排序，并支持交互式操作（如杀死进程、改变优先级）（`htop` 是 `top` 的更友好、功能更强的版本）；

  **可用键盘快捷键**

  - `P`：按照 CPU 使用率排序（默认排序方式）；
  - `M`：按照内存使用率（RES）排序；
  - `m`：切换内存信息显示区域开关、显示格式；
  - `T`：按照累计 CPU 时间排序；
  - `N`：按照 PID 排序；
  - `k`：杀死一个进程（会提示输入 PID 和信号）；
  - `q`：退出 `top`；
  - `f`：进入字段管理界面，可以选择显示或隐藏哪些列；
  - `1`：显示所有 CPU 核心的单独使用情况。

- `uptime [options]`：显示当前系统负载；

- `iotop [options]`/`iostat [options]`：显示磁盘 I/O 情况。

### 存储与内存操作

- `umount [options] <source> | <directory>`：卸载已挂载的文件系统；

  **可用选项**

  - `-a`：卸载所有文件系统；

  - `-l`：在文件系统忙时，先将其从目录树中分离，待设备不再忙时再真正清理；
  - `-f`：强制卸载。

- `lsof [names]`/`fuser -m NAMES`：查看占用 path 的进程；

- `mount [options] <source> <directory>`：手动挂载命令；

  - **可用选项**
    - `-a`：挂载所有在 `/etc/fstab` 提到的、具有 `auto` 或不具有 `noauto` 标记的、尚未被挂载的文件系统；
  - `-f`：假装执行（dry run），不真正执行挂载操作，仅用于测试。
    
  - **可用来源**
    - `UUID=xxxx-xxxx`：更稳定，不随设备节点名变化而变化；
    - `LABEL=MYDISK`：使用卷标。

- `df [options] [files]`：全称“Disk Free”，显示**磁盘**空间使用情况，包括挂载点，属于文件系统级别；

  **可用选项**

  - `-i`：显示文件系统的 inode 使用情况，输出中包含以下字段：文件系统、总 inodes 数、已用 inodes 数、可用 inodes 数、已用 inodes 百分比、挂载点；
  
  - `-h`：以“人类可读”的方式显示磁盘空间使用情况，不是 inode 信息；
  - `-k`：以 KB 为单位显示。
  
- `free [options]`：显示内存和交换空间（RAM 和 Swap）的使用情况；

  - **可用选项**
    - `-b`：以字节为单位显示；
    - `-m`：以 MB 为单位显示；
    - `-g`：以 GB 为单位显示；
    - `-s N`：以 N 秒为间隔持续动态显示；
    - `-h`：以人类可读的单位（G、M）显示，常用选项。
  - **返回字段**
    - **total**：总量；
    - **used**：已使用量；
    - **free**：空闲量；
    - **shared/buffers/cached**：缓冲/缓存占用量（可被程序快速回收）；
    - **Swap 行**：明确 swap 的相关信息。

- `du [options] [files]`：全称“Disk Usage”，估算**文件和目录**的磁盘使用量，用于扫描文件并计算大小，不提供 inode 信息，属于文件/目录级别；

  **可用选项**

  - `-a`：显示所有文件；
  - `-c`：显示总计，同时显示各个项目的大小；
  - `-sh <目录>`：汇总（`-s`）显示目录总大小，易读格式（`-h`）。

- `swapon [options] [<spec>]`：启用指定的交换分区或文件；

- `swapoff [options] [<spec>]`：关闭指定的交换分区或文件；

- `fdisk [options] <disk>`：分区表操作工具，它的每一个分区操作不会立即写入硬盘分区表；

  **相关交互命令**

  - `w`：保存并退出；
  - `q`：不保存退出；
  - `p`：打印当前分区表；
  - `n`：创建新分区；
  - `d`：删除分区；
  - `t`：改变分区类型；
  - `l`：列出已知的分区类型代码；
  - `m`：显示帮助菜单；
  - `x`：进入专家模式；
  - `r`：返回上一级菜单。

  **可用选项**

  - `-l`：列出列表，若未指定 `<disk>`，则列出所有磁盘的分区情况。

- `parted [options] [devices [commands [parameters]]]`：分区表操作工具，它的每一个分区操作都会立即写入硬盘分区表，且对 2 TB 及以上的超大硬盘和 GPT 有原生级别的良好支持，具备一些高级功能（如移动分区、复制分区）；

- `lsblk [options] [<devices>]`：列出所有块设备的信息，并以树状格式显示它们之间的依赖关系；

  - **可用选项**
    - `-f`：显示文件系统信息；
    - `-m`：显示权限信息；
    - `-p`：显示完整设备路径。
  - **输出字段**：`NAME  MAJ:MIN  RM  SIZE  RO  TYPE  MOUNTPOINTS`

- `mkfs [options] <device> [<size>]`：创建文件系统；

- `fsck [options] [<filesystems>]`：全称“File System Consistency Check”，检查并修复 Linux 文件系统。

### 网络操作

- `ifconfig [-a] <interface>`：配置和显示网络接口参数，若不带参数或只带接口名使用，则显示当前所有活跃的网络接口的状态信息；

  **可用选项**

  - `-a`：显示所有接口，包括未激活的接口。

- `ip [options] OBJECT {command}`：来自 `iproute2` 软件包，功能更强大，是推荐的新式工具；

  **可用对象命令**

  - `link show`：显示所有接口链路层状态；
  - `address show`：显示所有接口 IP 地址信息；
  - `route show`：查看路由表。

  > 虽然 `ifconfig` 非常经典，但在现代 Linux Distribution 中，它可能默认未安装，被更强大的 `ip` 命令取代。

- `netstat -i`：显示网络接口的统计信息表；

- `ping [options] <destination>`：发送 ICMP Echo Request 报文到目标主机，并等待接收 ICMP Echo Reply 报文，以此来测试网络层（IP 层）的连通性、延迟和丢包率，是检查底层 IP 连接性的最直接的工具，它返回往返时间（RTT）、丢包统计等信息，属于网络层（IP 层）诊断工具；

  **可用选项**

  - `-c <count>`：指定发送的包数；
  - `-i <interval>`：指定间隔。

- `ethtool`（查看网卡物理状态）/`mii-tool [options] <interfaces>`：物理/链路层诊断工具；

- `traceroute [options] HOST`/`tracepath [options] <destination>`：追踪 IP 路径，属于网络层（IP 层）诊断工具；

  - `traceroute [options] HOST`：通过发送特殊的探测包（通常使用递增的 TTL 值，Linux 默认 UDP 包），显示数据包到达目标主机所经过的每一跳的 IP 地址和延迟情况。
    - **可用选项**
      - `-n`：不解析主机名；
      - `-I`：使用 ICMP 包。

- `telnet [options]`/`nc [options]`（netcat）（测试特定 TCP/UDP 端口是否可达）：传输层诊断工具；

- `curl [options] <url>`/`wget [options] [URLs]`（测试 HTTP 等应用协议）/`nslookup`/`dig [options]`（测试 DNS 解析）：应用层诊断工具；

- `host [options] HOSTNAME [server]`：DNS查询工具，用于将主机名解析为 IP 地址，或反向解析；

- `mtr`：全称“My TraceRoute”，可实时、持续地显示到目标主机的路径和丢包率，是更高级的路径分析工具；

- `ifup <options> <ifaces>`：激活指定的网络接口，它会读取接口的配置文件（如 `/etc/sysconfig/network-scripts/ifcfg-eth0`），如果配置为 `BOOTPROTO=dhcp`，则 `ifup` 会发起 DHCP 请求，从 DHCP 服务器获取一个动态 IP 地址；

- `ifdown <options> <ifaces>`：停用指定的网络接口，它会释放当前接口占用的 IP 地址，并关闭接口，DHCP 客户端会通知服务器该 IP 地址可以被回收。

### 系统操作

- `su [options] [-] [<user> [<arguments>]]`：全称 Switch User，用于切换当前用户身份到其它用户；

  - 当 `<user>` 未指定时，默认切换到 root 用户，但保留当前用户的环境变量；
  - 当 `-` 被使用时，不仅进行用户切换，还会同时切换到对应用户的环境变量；
  - 执行该操作需要输入目标用户的密码（从 root 切换到其它用户不需要密码）。

- `sudo`：全称Super User DO，以其它用户的身份执行命令，且不需要知道 root 密码，只需输入自己的密码（需要 root 在 `/etc/sudoers` 中授权），其余用法与 `su` 类似，使用 `-` 时将启动一个交互式 Shell，环境变量为对应用户的环境变量；

- `hostname [options]`：显示或临时设置系统的主机名；

  **可用选项**

  - `-f`/`--fqdn`：显示完全限定域名（FQDN）；
  - `-i`：显示主机的 IP 地址。

- `hostnamectl [options] COMMANDS`（systemd）：查询和更改系统主机名及相关设置，是更现代的方法；

  **可用命令**

  - `status`：显示当前主机名等信息；
  - `set-hostname NEW-HOSTNAME`：永久修改主机名。
  
- `uname -n`：显示主机名（`-n` 表示 `nodename`）；

- `service <option> | --status-all | [ service_name [ command | --full-restart]]`（System V init）：运行 System V init 风格的启动脚本，从而控制系统服务（如启动、停止、重启、查看状态）；

  - **可用命令**：`start`（启动）、`stop`（停止）、`restart`（重启）、`status`（查看状态）、`reload`（重新加载配置）。

- `systemctl [options] COMMANDS`（systemd）：在现代 Linux Distribution 中，`systemctl` 是更现代的方法；

  **可用命令**：`enable`：设置服务开机自启动。

  > 在 Red Hat、CentOS、Fedora 等 RHEL 系发行版中，Apache 的服务名通常是 `httpd`；在 Debian/Ubuntu 系中，Apache 的服务名通常是 `apache2`。

- `rsyslogd`/`syslogd`：传统的系统日志守护进程，负责收集和分发日志消息；

- `journalctl`（systemd）：日志查看工具，用于查询 `journald` 收集的二进制日志；

- `logwatch`：可定制的日志分析程序，它解析系统的原始日志文件，过滤出重要信息，生成结构化的、易于阅读的每日摘要报告，并通过邮件发送给管理员或输出到标准输出，可通过 `/etc/logwatch/conf/` 定制要分析的日志文件、过滤规则和报告细节，通常通过 `cron` 进行自动化运行；

- `logrotate`：日志轮转工具，负责对日志文件进行切割、压缩、归档和删除，防止日志文件无线增大占用空间；

- `lastlog`：特定日志的查询工具，用于显示系统中所有用户的最近一次登录信息；

- `env [options] [names=value] [commands [arg]]`：查看环境变量；

- `printenv [options] [variables]`：查看环境变量；

- `blkid --label <label> | --uuid <uuid>`：查看指定设备的 UUID；

- `echo [options]<str>`：输出指定字符串；

  **可用选项**

  - `-e`：启用转义字符解释；
  - **可用的转义字符**
      - `\b`：Backspace，退格；
      - `\n`：换行；
      - `\t`：水平制表符；
      - `\\`：反斜杠字符本身；
      - `\r`：回车（将光标移动到行首）。
  - `-n`：输出文本时不换行。

- `last [options] [<usernames>] [<ttys>]`：显示用户登录历史；

- `lscpu [options]`：显示 CPU 架构信息，与块设备无关；

- `dmesg [options]`：显示内核环形缓冲区的消息，常用于查看硬件检测和驱动加载日志；

- `vmstat [options] [delay [count]]`：报告关于进程、内存、分页、块 I/O、陷阱、CPU 活动的虚拟内存统计信息；

- `which [options] ARGS`：显示 ARGS 命令的可执行文件路径；

- `whereis [options] <name>`：显示指定包的二进制文件、源文件和 man 手册页的位置。

### 常用语法

- **路径表示**：`./subdir` 当前目录的子目录，`../parent` 上级目录；
- **通配符解析**
  - `*`：匹配任意数量的任意字符；
  - `?`：匹配恰好一个的任意字符；
  - `[abc]`：匹配方括号内任意一个字符；
  - `[a-z]`、`[0-9]`：匹配指定范围内的任意一个字符；
  - `[!abc]` 或 `[^abc]`：匹配不在方括号内的任意一个字符；
  - `{}`：大括号扩展，用于生成字符串列表；
- **正则表达式**
  - `^001`：匹配以 `001` 开头的行；
  - `001$`：匹配以 `001` 结尾的行；
  - `*`：表示前面的字符重复零次或多次；
  - `.`：匹配任意单个字符（除换行符）；
  - `+`：匹配一次或多次；
  - `?`：匹配零次或一次；
  - `[]`：字符集合，匹配方括号内的任意一个字符。
- **引号机制**
  - **单引号`'`**：代表强引用或全引用，单引号内的所有字符都保持字面意义，Shell 不进行任何特殊解释，转义字符也无效；
  - **双引号`"`**：代表弱引用，双引号内的大部分字符保持字面意义，但会进行变量扩展（`$VAR`）、命令替换（`$(instruction)`）和转移字符（`\`）的解释；
  - **无引号**：可能会引发意外行为，视 Shell 如何理解。
- **其它**
  - `>`：重定向/覆盖；
  - `>>`：追加；
  - `|`：管道，将前一个命令的标准输出作为后一个命令的标准输入；
  - `\`：续行符，Shell 会将该行和下一行视为一个整体，表示命令尚未结束，将在下一行继续输入，提高可读性，其后必须紧跟回车，不能有其它字符；
  - `:`：空命令，起占位符作用。

## Linux 文件描述符

- **0（stdin）**：标准输入，默认来自键盘；

- **1（stdout）**：标准输出，默认输出到终端；

- **2（stderr）**：标准错误输出，默认输出到终端。

## Linux 重定向语法

`2>`：将 stderr 重定向到某个地方；

`&1`：`&` 表示对 stdout 的引用，不是一个名叫 1 的文件；

`2>&1`：将 stderr 重定向到 stdout 指向的地方；

`wc < a.dat`：输入重定向，将文件 `a.dat` 的内容作为 `wc` 的标准输入；

`wc >> output.ls`：输出追加重定向，将 `wc` 的标准输出追加到文件 `output.ls` 的末尾，文件不存在则创建。

- **示例 1**

  ```bash
  command > output.log 2>&1
  ```

  **第一步**：`> output.log` 将 stdout 重定向到文件 `output.log`；

  **第二步**：`2>&1` 将 stderr 重定向到 stdout。

- **示例 2**

  ```bash
  command > /dev/null 2>&1
  ```

  易于理解，将所有输出丢弃。

> 如果指定的目标重定向位置（通常是 filename）不存在时，则创建一个新的文件用于存放重定向内容。

## Linux 文件系统

### 常见文件系统简介

- **EXT 系列**：Linux 原生且历史悠久的文件系统家族，包括 ext，ext2，ext3，ext4，其中 ext4 是目前大多数现代 Linux Distribution 的默认文件系统，它提供了良好的性能、稳定性和特性（如日志）；

- **VFAT**：Windows 和 DOS 系统使用的 FAT 文件系统（如 FAT32）的一种变体，支持长文件名，Linux 可读写。

- **ISO9660**：光盘（CD-ROM）的标准文件系统；

- **NTFS**：Windows NT 及后续系统的原生文件系统，Linux 内核通过模块支持读写 NTFS；

- **XFS**：高性能日志文件系统，常用于大型存储服务器（如 RHEL/CentOS 7+ 的默认文件系统）；

- **Btrfs**：具有高级特性（如写时复制、快照、压缩）的现代文件系统；

- **ZFS**：功能强大的文件系统和卷管理器，源自 Solaris；

- **HFS+**：macOS 通常使用的文件系统；

- **NFS**：全称“Network File System”，允许网络中的计算机之间共享文件和目录，客户端可以将服务器导出的目录挂载到本地目录树中，实现对远程文件的透明访问，它基于客户端/服务器模型，常用于 Unix/Linux 系统集群中，共享家目录、应用程序或数据。（替代方案有用于与 Windows 共享的 Samba，CIFS/SMB）

  > Linux 使用正斜杠作为目录和文件之间的分隔符，Windows 使用反斜杠；
  >
  > Linux 的文件系统区分大小写，而 Windows 的 NTFS 文件系统不区分。

### 层次结构标准（FHS）

与 Windows 的盘符概念不同，Linux将所有存储设备都挂载到唯一的目录树中，形成一个统一的访问视图。

- `/home`：存放普通用户的家目录；

  > 例如普通用户 bob 的家目录为 `/home/bob`；
  >
  > 普通用户对自己的家目录拥有三大完全控制权（读、写、执行）；

  - `~/.bash_profile` 或 `~/.bash_login` 或 `~/.profile`：当用户登录时，在 `/etc/profile` 执行后，按此顺序寻找第一个存在的执行；
  - `~/.bashrc`：用户打开一个新的非登录终端窗口时执行。

- `/usr`：全称“Unix System Resources”，存放系统级应用程序、库、文档和只读数据；

  -  `/usr/bin/`：存放用户命令；
  -  `/usr/lib/`：存放库文件；
     - `/usr/lib/systemd/system`：系统安装的服务单元。
  -  `/usr/sbin`：存放系统管理命令（通常只有 root 可以执行）;
  -  `/usr/share/doc`：软件包的文档；
  -  `/usr/share/man`：软件包的手册页；
  -  `/usr/include`：软件包的头文件（开发包）。

- `/root`：root 用户的专属家目录；

- `/etc`：全称“Editable Text Configuration”（可编辑文本配置）或习惯称为“Etcetera”，存放系统全局配置文件；

  - `/etc/passwd`：存放用户账户信息；
  
    `username:encrypted_password(x):UID:GID:description:home_dir:login_shell`
    
    其中第 2 字段（密码字段）统一记为 `x`，表明实际密码已转移到 `/etc/shadow`，其它信息包括：用户名、UID 和 GID、描述、家目录、登录 Shell；
  
    文件权限为 `644`。
  
  - `/etc/shadow`：存放密码影子文件（加密密码 - 哈希值）及其它与密码相关的安全信息，仅 root 用户可读；
  
    `username:encrypted_password:last_change:min_age:max_age:warn:inactive:expire:reserved`
    
    - **关键字段**：
    - 第2字段：**加密后的密码**。如果为空或`!`、`*`，表示该用户不能用于登录（密码登录）；
      - 第3字段：上次修改密码的日期（从1970年1月1日算起的天数）；
      - 第5字段：密码的最大有效天数（强制更改周期）；
      - 第7字段：账户过期后，被彻底禁用前的宽限天数。
    - 文件权限为 `400`。
    
  - `/etc/gshadow`：存放用户组的加密密码、组管理员列表以及组成员列表；
  
  - `/etc/group`：存放用户组信息，包括组名、组密码（通常不使用，用 `x` 代替）、GID、属于该组的用户列表；
  
  - `/etc/fstab`：全称“File System Table”（文件系统表），开机自动挂载配置；
  
    `<设备/UUID/LABEL> <挂载点> <文件系统类型> <挂载选项> <dump备份标记> <fsck检查顺序>`
    
  - `/etc/mtab`：记录当前已挂载的文件系统信息（实际上是 `/proc/mounts`）；
  
  - `/etc/hosts`：主机名与 IP 地址的本地映射关系定义；
  
    `127.0.0.1   localhost localhost.localdomain`
    `192.168.1.100 server1.example.com server1`
    `192.168.1.200 mypc`
    
  - `/etc/resolv.conf`：配置系统的 DNS 客户端；
  
  - `/etc/networks`：定义网络名称与网络地址的映射；
  
  - `/etc/nsswitch.conf`：`host` 行控制主机名解析顺序，典型顺序是 `hosts:  files dns`，代表先查询 `hosts` 文件，若无，则再查询 DNS；
  
  - `/etc/hostname`：主机名配置文件，修改后永久生效；
  
  - `/etc/init.d/`：System V init 服务脚本（守护进程）；
  
  - `/etc/profile`：系统为所有用户设置环境信息和启动程序的第一个文件，用户登录时，该文件被执行，通常用于设置全局 PATH、环境变量等；
  
  - `/etc/bash.bashrc`：为所有运行 bash shell 的用户设置 bash 特有的环境信息和别名，通常被 `/etc/profile` 或用户个人的 `~/.bashrc` 调用；
  
  - `/etc/security/`：存放系统安全策略相关的配置文件；
  
  - `/etc/sudoers`：`sudo` 提权命令的授权配置；
  
  - `/etc/systemd/system/`：管理员创建或覆盖的自定义服务单元；
  
  - `/etc/profile`：所有用户登录时都会读取的系统级环境变量设置；
  
  - `/etc/bashrc` 或 `/etc/bash.bashrc`：所有用户运行交互式非登录 Shell 时读取的系统级配置。
  
- `/var/`：存放可变数据（Variable data），如日志、缓存、邮件、假脱机文件等；

  - `/var/log/`：存放系统和应用程序的日志文件；
    - `/var/log/syslog`：通用系统活动日志（核心日志）；
    - `/var/log/auth.log`：身份验证和安全相关日志；
    - `/var/log/dmesg`：内核环形缓冲区日志，记录硬件和驱动信息。
  - `/var/run/`：存放运行时可变数据，例如进程 ID 文件（.pid），服务状态文件、用户登录会话信息等。
  
- `/proc/mounts`：内核记录的挂载信息；

- `/proc/swaps`：已启用的 swap 区域；

- `/proc/meminfo`：原始内存信息文件；

- `/mnt/`：临时手动挂载的传统位置；

- `/media/`：自动挂载可移动介质的常用位置；

- `/boot/`：引导分区挂载点，存放 Linux 内核文件（vmlinuz-*）和引导加载程序（Bootloader）的相关文件；

  - `vmlinuz-<version>`：压缩的 Linux 内核映像文件；
  - `initramfs-<version>.img`：初始内存文件系统，用于内核启动初期加载必要的驱动和模块；
  - `/boot/grub/` 或 `/boot/grub2`：GRUB 引导加载程序的配置文件目录；
  - `System.map-<version>`：内核符号表。

- `/dev/`：存放设备文件；

  - **硬盘/分区**：`/dev/sda`、`/dev/sda1`；
  - **光驱**：`/dev/sr0`、`/dev/cdrom`；
  - **终端**：`/dev/tty`、`/dev/pts/*`；
  - **空设备**：`/dev/null`；
  - **随机数发生器**：`/dev/random`、`/dev/urandom`。

- `/bin/`：存放系统基本的用户命令二进制文件； 

- `/lib/` 和 `/lib64/`：存放系统最基本的共享库和内核模块，供 `/bin/` 和 `/sbin/` 中的程序使用；

- `/sbin/`：存放启动和修复系统时必需的系统管理命令。

### 挂载（Mount）

挂载点是一个目录，作为新文件系统接入整个目录树的访问入口。挂载点目录在挂载前最好是一个空目录，如果非空，挂载后，原目录内容将被暂时隐藏，直到卸载后才会重新显示。

### 磁盘设备命名规则

#### 传统 IDE 磁盘

- IDE（或PATA）接口的硬盘使用 `hd` 作为前缀；
- 设备名分为三部分：`/dev/hd[a-z]`，最后一个字母为盘序（按第一块主盘、第一块从盘、第二块主盘、第二块从盘依次排序）；
- 每个磁盘上的分区编号从 `1` 开始，如 `/dev/hda1`、`/dev/hda2`。

#### 现代磁盘

- SATA、SCSI、SAS 以及大部分的 USB 存储设备使用 `sd` 作为前缀；
- 设备名分为三部分：`/dev/sd[a-z]`，最后一个字母为盘序；
- 每个磁盘上的分区编号从 `1` 开始，如 `/dev/sda1`、`/dev/sda2`。

> 注意分区类型：
>
> - 主分区：编号 1-4；
> - 扩展分区和逻辑分区：从 5 开始编号。

#### 软 RAID 设备

- 软 RAID 设备使用 `md` 作为前缀；
- 设备名分为三部分：`/dev/md[0]`，最后一个数字是 RAID 阵列编号。

#### 其它

如 VMware 虚拟磁盘可能是 `/dev/sdX`，VirtIO 设备可能是 `/dev/vdX`。

### inode、硬/软链接

#### inode

inode 全称“Index Node（索引节点）”，是文件系统中的一个数据结构，用于存储数据的元数据每个文件或目录都对应一个唯一的 inode，对于 Ext 系列文件系统，在创建时就会固定 inode 的总数量，而 XFS、Btrfs 等现代文件系统是动态分配的。如果 inode 被耗尽，即使磁盘还有剩余空间，也无法创建新文件或目录（抛出错误“No space left on device”），常见于存储大量小文件的系统。原数据包含：

- 类型；
- 权限；
- 所有者和所属组（UID 和 GID）；
- 时间戳（inode 状态改动时间 ctime、修改 mtime、访问时间 atime）；
- 文件大小；
- 指向数据块的指针；
- 链接计数（指向该 inode 的目录项数量）；
- 文件占用的块数等。

#### 硬链接

多个文件名指向同一个 inode，inode 链接计数增加，不能跨文件系统，不能链接目录（防止在文件系统中创建循环引用，导致遍历算法陷入无限循环或损坏目录树结构）。

#### 软链接

是一个独立的文件（有自己的 inode），其内容是目标文件的路径，可以跨文件系统，可以链接目录。

### MBR 分区表

MBR（Master Boot Record）分区表存储硬盘的第一个扇区，其大小固定为 512 字节，由于其中能够描述分区的空间极其有限，故只允许 4 条分区记录，被称为主分区（Primary Partition）。若需要更多的分区，可以将其中一个分区标记为扩展分区（Extended Partition），该分区不直接存储数据，而是作为一个容器，在其内部可创建多个逻辑分区（Logical Partition），其数量只受硬盘和容量和 OS 的限制。

> MBR 已经过时，现代操作系统通常使用 GPT（GUID Partition Table）分区表，它具备更新的标准，更灵活的分区管理方式，通常与 UEFI 引导配合，通常支持多达 128 个或更多的分区，非常适用于新式机器。

### 两种基本分区类型

- **根分区 `/`**：这是 Linux 文件系统的起点，所有其它目录都挂载在其下（除非单独分区）；

- **交换分区（Swap Partition）**：特殊分区，用于虚拟内存，当 RAM 不足时，系统会将内存中不活跃的数据移入 swap 分区，从而为当前活动进程腾出内存空间，不需要挂载点，只需要在分区时指定分区类型为 `82`（Linux swap）。

  > Linux 交换空间还可以使用交换文件（Swap file）实现，类似于 Windows 的虚拟内存的 sys 文件。

## Linux 文件权限

- **字符表示法**

  |  `u`   |   `g`    |   `o`    |    a     |
  | :----: | :------: | :------: | :------: |
  | 所有者 | 同组用户 | 其它用户 | 以上所有 |
  | **r**  |  **w**   |  **x**   |          |
  | 读权限 |  写权限  | 执行权限 |          |

  例如：`rwxr-xr--` 共 9 位，每 3 位一组，分别代表 `u`、`g`、`o` 的权限。

- **八进制表示法**：将每组权限看作一个3位二进制数（`r` = 4，`w` = 2，`x` = 1），然后转为八进制；

  > `r--` = 100 = 4
  >
  > `-w-` = 010 = 2
  >
  > `--x` = 001 = 1
  >
  > `rw-` = 110 = 4 + 2 = 6
  >
  > `r-x` = 101 = 4 + 1 = 5
  >
  > `rwx` = 111 = 4 + 2 + 1 = 7
  
- `chmod` **命令的一些示例用法**：

  - `chmod u+x file`：给所有者增加执行权限；
  - `chmod go-x file`：移除组和其它用户的执行权限；
  - `chmod a=r file`：给所有用户设置只读权限；

- `chown [options] [owner][:[group]] FILES`：修改文件所有者和所属组。

- **umask 权限屏蔽**：其值代表着在新建目录或文件默认情况时屏蔽的权限，例如 umask 值为 002（二进制 000 000 010），代表屏蔽其他用户的写权限，以此类推；

- **默认权限**：文件 = 666，目录 = 777。

- **特殊权限位**：

  特殊权限位位于所有者权限位前，用于是设置特殊权限。该位置可填值同是 4，2，1。

  - **4 - SUID**：全称“Set User ID”，当一个可执行文件被添加了 SUID 位后，其有效用户 ID（EUID）会被临时设置为该文件所有者的用户 ID，从而拥有文件所有者的权限；
  - **2 - SGID**：对于文件，类似于 SUID 但使用文件所属组的权限，对于目录，在该目录下新建的文件将继承目录的组身份；
  - **1 - Sticky Bit**：常用于公共目录，确保只有文件所有者才能删除或重命名自己的文件。

## Linux 设备类型

### 块设备（Block Devices）

- **定义**：以数据块为单位进行随机读写的存储设备。数据块大小通常为 512 字节、1 KB、4 KB等；
- **特点**
  - **随机访问**：可以跳转到任意数据块位置进行读写；
  - **缓存机制**：用于提高读写效率；
  - **持久化存储**。
- **典型代表**：硬盘、光盘驱动器、可移动驱动器、SD 卡、磁盘分区等；
- **设备文件**：在 `/dev` 目录下，块设备文件通常显示为 `b` 类型。

### 字符设备（Character Devices）

- **定义**：以字符流为单位进行顺序读写的设备，通常不支持随机寻址；
- **特点**
  - **顺序访问**：数据像水流一样依次传输；
  - **即时输入/输出**：无或仅有很少的缓存。
- **典型代表**：串行口（`/dev/ttyS0`）、虚拟终端（`/dev/tty`）、打印机、键盘、鼠标、声卡等；
- **设备文件**：在 `/dev` 目录下，字符设备文件通常显示为 `c` 类型。

### 特殊类型

**网络设备**（如网卡 eth0），在  `/dev` 下没有对应的设备文件，而是由内核通过套接字接口管理，既不属于块设备也不属于字符设备。

## Linux 网络设备命名规则

- **传统命名规则**

  以太网（Ethernet）接口被命名为 `ethX`，其中 `X` 是从 0 开始的数字。

- **现代命名规则**

  - 从 systemd 和 udev 引入后，许多现代 Linux 发行版采用了可预测的网络接口命名，这种命名方式基于固件、拓扑、位置等信息，使得名称在重启后更稳定，常见前缀有：
    - `en`：全称 Ethernet，以太网接口，如 `ens33` （PCIe 热插拔槽位）；
    - `wl`：全称 WLAN，无线局域网接口，如 `wlp3s0`；
    - `ww`：全称 WWAN，无线广域网接口，如 4G 网卡。

  > 常见的非传统接口还有：
  >
  > - `lo`：本地环回接口；
  > - `wlan0`：传统无线网卡接口；
  > - `br0`：网桥接口；
  > - `bond0`：绑定（聚合）接口；
  > - `docker0`/`vethXXX`：Docker 创建的虚拟接口。

## Linux 编辑器用法

### Vi/Vim 编辑器

![img](img_01.gif)

- `set`  **选项详解**（输入英文冒号才能进入底行模式，才能输入 `set` 命令）：
  - `set report=n`：当一次操作（如删除、复制、修改）影响的行数超过 n 时，在底部显示反馈信息；
  - `set scroll=n`：按 `Ctrl + D/U` 翻页时一次滚动 n 行；
  - `set shiftwidth=n`：使用 `>>`、`<<` 或自动缩进时，每一级缩进占 n 个空格；
  - `set nu`/`set number`：显示行号；
  - `set nonu`/`set nonumber`：隐藏行号；
  - `set ic`：搜索时忽略大小写；
  - `set noic`：搜索时区分大小写；
  - `set hlsearch`：高亮显示搜素结果；
  - `set nohlsearch`：取消高亮搜索结果；
  - `syntax on`：打开语法高亮；
  - `syntax off`：关闭语法高亮；
  - `set autoindent`/`set ai`：自动缩进；
  - `set ruler`：状态栏显示光标当前位置（行号、列号），但不显示整个文档的行号；
  - `set all`：显示所有配置选项的当前值；
  - `set`/`se`：只显示与默认值不同的选项；
  - `set option?`：显示指定选项 `option` 的当前值；
  - `set option&`：将指定选项 `option` 重置为默认值。
- **光标移动命令**
  - `G`：光标移动至文件最后一行行首；
  - `[数字]G`：光标移至指定数字行号的行首；
  - `[数字]|`：光标移至当前行的指定列号；
  - `$`：光标移至当前行尾；
  - `0`：光标移至当前绝对行首；
  - `^`：光标移至当前第一个非空白字符；
  - `[数字]l`：光标向右移动指定个数的字符；
  - `[数字]h`：光标向左移动指定个数的字符；
  - `w`/`b`：光标移至下一个 / 上一个单词的词尾；
  - `e`：光标移至当前或下一个单词的词尾；
  - `gg`：光标移至文件第一行；
  - `G`：光标移至文件最后一行；
  - `:[行号]`：跳转到指定行；
  - `^G`：显示当前光标所在位置信息（文件名、是否修改、行号、列号、总行数等）;
- **文本编辑命令**
  - `[数字]dd`：剪切光标所在的当前整行；
  - `x`：删除光标所在处的一个字符；
  - `dw`：delete word，删除从光标位置到下一个单词开头的内容；
  - `db`：delete backward，删除从光标当前位置向前（向左）到上一个单词开头的内容；
  - `de`：删除从光标位置到单词词尾的内容；
  - `dd`：删除当前整行；
  - `cc`：change line，删除当前行并进入插入模式；
  - `d$`/`D`：删除从光标位置到行尾的内容；
  - `d^`：删除从光标位置到行首（第一个非空白字符）的内容；
  - `[n]yy`：复制当前行（或复制从当前行开始的 n 行）；
  - `yw`：复制当前词；
  - `p`：粘贴到光标后/下方；
  - `P`：粘贴到光标前/上方；
  - `u`：撤销；
  - `^R`：重做；
  - `o`：在当前光标所在行的下方插入一个新行，并将光标移动到新行行首，进入插入模式；
  - `O`：在当前光标所在行的上方插入一个新行，并将光标移动到新行行首，进入插入模式；
  - `i`：在光标当前位置之前插入，进入插入模式；
  - `a`：在光标当前位置之后插入，进入插入模式；
  - `I`：将光标移动到当前行行首（第一个空白字符），进入插入模式；
  - `A`：将光标移动到当前行行尾，进入插入模式。
- **快捷命令**
  - `:q!`：不保存任何修改，强制退出 Vi 编辑器；
  - `:wq`：全称“Write and quit”，保存修改并退出；
  - `:w`：保存文件；
  - `:w <新文件名>`：另存为新文件；
  - `:x` 或 `ZZ`：保存并退出；
  - `:e!`：放弃所有未保存的更改，重新加载磁盘上的原始文件;
  - `.`：重复上一次的操作；
  - `*`：向前（向下）搜索当前光标所在的处的单词；
  - `:[范围]s/原字符串/新字符串/[标志]`：执行全局替换。
    - **范围**
      - `%`：整个文件（从第一行到最后一行）；
      - `1,$`：从第 1 行到最后一行；
      - `.,$`：从当前行到最后一行；
      - 缺省默认行为是只对当前行进行操作。
    - **标志**
      - `g`：全局（global），替换一行中所有匹配项（而不仅仅是第一个）；
      - `c`：每次替换前确认（confirm）；
      - `i`：忽略大小写（ignore case）。
- **三种基本工作模式**
  - **命令模式（Command Mode）**：vi 启动后的默认模式，在此模式下，键盘输入被视为命令，按 `Esc` 键可从其它模式返回此模式；
  - **编辑模式（Insert Mode）**：此模式用于和其它普通编辑器一样键入文本，从命令模式按 `I`（Insert），`A`（Append），`O`（Open new line）等键进入；
  - **末行模式（Last Line Mode / Ex Mode）**：在命令模式下按 `:` 进入，可输入 `set` 相关的命令。

### Emacs 编辑器

- **键盘快捷键**

  以下包含缩写，`^` 代表 `Ctrl`。

  - **有前缀的快捷键**：`^x` 是前缀组合键，用于引导一系列文件、缓冲区操作命令；
    - `^X^F`：`load-new`，打开（查找）文件，若文件不存在则创建，不会替代当前缓冲区；
    - `^X^S`：`save`，保存当前缓冲区到文件；
    - `^X^W `：`write-new`，将当前缓冲区另存为新文件；
    - `^X^C`：`exit`，退出 Emacs。
  - **无前缀的快捷键**
    - `^V`：光标向前（向下）移动一屏；
    - `altV`：光标向后（向上）移动一屏；
    - `^F`：光标向前（Forward）一个字符；
    - `^B`：光标向后（Backward）一个字符；
    - `altF`：光标向前一个单词；
    - `altB`：光标向后一个单词；
    - `alt<`/`^<Home>`：移动到文件开头；
    - `alt>`/`^<End>`：移动到文件结尾；
    - `^N`：光标移至下一行（Next）；
    - `^P`：光标移至上一行（Previous）；
    - `^A`：光标移至行首（Ahead of line）；
    - `^E`：光标移至行尾（End of line）。

- **模式行（Mode Line）**：位于每个窗口的底部，用于显示当前缓冲区、主要模式、编辑状态等信息，其中一个字段用来表示当前缓冲区的修改和读写状态；

  - `--`：只读缓冲区，且未被修改；
  - `**`：缓冲区已被修改，且未保存；
  - `%%`：缓冲区未被修改；
  - `%*`：只读缓冲区，且已被修改。

## Linux  GNU 编程

### GDB 用法

GDB 是指 GNU 调试器。

- `whatis <var_or_expression>`：显示变量或表达式结果的数据类型；

  ```bash
  (gdb) whatis counter
  type = int
  (gdb) whatis argv
  type = char **
  ```

- `set`：用于设置 GDB 内部变量或修改被调试程序的变量值，如 `set var i=1`；

- `kill`：终止当前正在被 GDB 调试的进程；

- `print`：打印变量或表达式的值；

- `run`/`r`：运行程序；

- `start`：开始执行程序，并在 `main` 函数处暂停；

- `break`/`b`：设置断点，如 `b main`；

- `info breakpoints`：查看所有断点；

- `delete`：删除断点；

- `clear <行号>/<函数名>`：删除设置在指定行号/指定处的所有断点

- `next`/`n`：单步执行，且跳过函数调用的调试（末尾加 `i` 表示进入汇编指令级别）；

- `step`/`s`：单步执行，且进入函数调用的调试（末尾加 `i` 表示进入汇编指令级别）；

- `continue`/`c`：继续运行直到下一个断点；

- `finish`：继续运行，直到当前函数返回，然后暂停；

- `until`/`u`：运行到指定行号或当前循环结束；

- `backtrace`/`bt`：显示调用堆栈；

- `info locals`：显示当前栈帧的所有局部变量；

- `info args`：显示当前函数的参数值；

- `frame`/`f`：查看当前栈帧的详细信息；

- `up`/`down`：在调用栈中向上（调用者）或向下（被调用者）移动，切换当前栈帧；

- `list`/`l`：显示源代码；

  - `list <行号>`：显示指定行号周围的源代码；
  - `list <函数名>`：显示指定函数周围的源代码；
  - `list <文件>:<行号>`：显示指定文件的指定行周围的源代码。

- `show`：显示 GDB 本身的内部设置信息；

- `disp`：设置自动显示，即每次程序暂停时自动打印指定表达式的值；

- `quit`/`q`：退出 GDB。

> **GDB 条件断点**
>
> - **功能**：断点只有在指定的条件为真时才会暂停程序执行；
> - **语法**：`break [位置] if 条件`；
> - **位置**：可以是行号、函数名、文件名:行号等；
> - **条件**：任何合法的 C/C++ 表达式，可以使用变量、常量、运算符等。

### GCC 用法

GCC 是指 GNU 编译器集合。

- **用法**：`gcc [options] SOURCE -o OUTPUT`；

- **可用选项**
  - `-g`：在编译时，将调试信息（如符号表、变量类型、源代码行号映射等）嵌入到生成的可执行文件或目标文件中，使得 GDB 能够对其进行源代码级别的调试，这会增大生成文件的文件体积，但不影响程序的运行性能；

    用法：`gcc -g -o program program.c`；

  - `-E`：只进行预处理，输出到标准输出；

  - `-S`：只进行预处理和编译，生成汇编代码（`.s` 文件）；

  - `-c`：只进行预处理、编译和汇编，生成目标文件（`-o` 文件），不链接；

  - `-o <file>`：指定输出文件名；

  - `-O0`/`-O1`/`-O2`/`-O3`：指定优化级别，`-O0`为不优化，便于调试；

  - `-w`：禁止所有警告信息；

  - `-Wall`：启用所有常见警告；
  
  - `-Werror`：将所有警告视为错误，当有警告时编译失败；
  
  - `-Wextra`：启用额外的警告；
  
  - `-L <dir>`：指定库文件（`.a` 或 `.so`）的搜索路径；
  
    > 库搜索顺序：
    >
    > - `-L` 选项指定的路径（按顺序）；
    > - 环境变量 `LIBRARY_PATH` 指定的路径；
    > - 系统默认路径（如 `/lib`，`/usr/lib`，`/usr/local/lib`）。
  
  - `-l <lib_name>`：用于链接指定的库，如 `-lm` 链接数学库，`-lpthread` 链接线程库；
  
  - `-I <dir>`：指定头文件的搜索路径。 
  
  > GCC 的四个阶段：**E** (预处理) -> **S** (编译) -> **C** (汇编) -> **无选项** (链接)。

### Make 用法

make 工具用于管理依赖关系，根据文件时间戳决定需要重新编译的部分，最终生成目标；它是 GNU 的工程化编译工具，用于编译大量互相关联的源代码；它从 Makefile 文件中读取依赖规则。

- **Makefile 规则格式**

  ```makefile
  target ... : prerequisites ...
  	recipe
  	...
  	...
  ```

  - **target（目标）**：通常是要生成的文件名，也可以是一个动作名称（伪目标，如 `clean`）；
  - **prerequisites（先决条件/依赖）**：生成 target 所需要的文件或其它目标；
  - **recipe（配方/命令）**：一系列由 Tab 键开头的 shell 命令，用于说明如何从依赖文件生成目标文件；

- **make 与 Makefile 核心概念**

  - **默认目标**：执行 `make` 命令时，若无指定目标，则执行 Makefile 中的第一个目标（通常名为 `all`）；
  - **伪目标（`PHONY`）**：用于定义不是文件名的目标，如 `clean`，`install`。使用 `.PHONY: clean`声明可以避免与同名文件冲突；
  - **自动变量**：在规则中可使用特殊变量名，如：
    - `$@`：代表当前规则中的目标文件名；
    - `$<`：代表第一个依赖文件名；
    - `$^`：代表所有依赖文件列表。
  
- **相关命令**

  - `make clean`：执行 Makefile 定义的 `clean` 目标下的命令，通常用于删除所有由 `make` 生成的文件（如目标文件、库文件、可执行文件等），是源代码目录恢复到编译前的状态；
  - `make install`：将编译好的程序、库、头文件等安装到系统目录；
  - `make uninstall`：上一操作的逆操作，需要 Makefile 支持；
  - `make distclean`：比 `clean` 更彻底的清理操作，通常还会删除由 `configure` 脚本生成的配置文件（如 `Makefile`、`config.h`），使目录恢复到发布时的原始状态。

## Linux Java 编程

- `java`：Java 运行时命令行工具；

  **可用选项**

  - `-version`：显示当前系统中默认使用的 Java 运行时环境（JRE）或 Java 开发工具包（JDK）的版本信息，输出内容通常包括 Java 版本号、运行时环境名称（Java SE Runtime Environment）、虚拟机名称和版本等。

- `javac`：Java 编译器；
- `jps`：Java 进程查看；
- `jar`：用于创建和管理 JAR（Java Archive）文件。

## Linux 环境变量

- `~`/`$HOME`：当前用户的家目录；
- `PS1`：全称 Primary Prompt String 1（主提示符字符串），定义 Shell 的主命令提示符的格式和内容，常用转义序列有：
  - `\u`：当前用户名；
  - `\h`：短格式主机名；
  - `\H`：完整主机名；
  - `\w`：当前工作目录的完整路径；
  - `\W`：当前工作目录的基名（最后一个目录名）；
  - `\$`：如果用户为 root，显示 `#`，否则显示 `$`。
  - 默认的 `PS1` 通常设置为 `[\u@\h:\W]\$`，例如 `renahsacme@WSL-RENAHSACME:~$`（用户名是 renahsacme，主机名是 WSL-RENAHSACME，工作目录在 renahsacme 的家目录，$ 表示当前不是 root 用户）。
- `PS2`：辅助（续行）提示符，当命令需要多行输入时显示的提示符，默认为 `>`；
- `PS3`：用于 `select` 循环的提示符；
- `PS4`：用于调试脚本时的提示符（在 `set -x` 模式下显示）；
- **生效方式**
  - **临时生效**：若要使某变量在当前 Shell 及其子进程中成为环境变量，只需执行 `export PS1`；
  - **永久生效**：在当前用户的家目录下的 Shell 配置文件中进行修改（对于 bash，路径在 `~/.bashrc`）。

## Linux Shell 用法

- Shell 是用户与Linux 内核之间的接口，它接收用户输入的命令，并将其解释执行或传递给内核；

- Shell 是包裹在内核之外的“外壳”，为用户提供操作界面；

- Shell 的核心功能是解释并执行用户的输入的命令，也是一种编程语言的解释器；

- Shell 在某种意义上算是一种脚本编程语言（例如 Bash 脚本），属于解释型语言，具有命令和流程控制的特点，主要用于开发自动化任务、调用系统命令、管理操作系统。

  > 与其它类型的编程语言区分开来。例如 C 语言属于编译型语言，主要用于系统底层开发、应用程序开发等，具有结构化特点。

### **键盘快捷键**

- `Tab`：自动补全可能的剩余部分；
  - **按一次 `Tab`**：若根据已输入的字符能唯一确定一个补全项，则直接补全；
  - **按两次 `Tab`**：若根据已输入的字符有多个可能，则按第一次显示一个推测结果，再按一次会列出所有可能的补全项供选择。
- `^A`：移动到行首（Ahead）；
- `^E`：移动到行尾（End）；
- `^F`：向前（Forward）移动一个字符；
- `^B`：向后（Backward）移动一个字符；
- `altF`：向前移动一个单词；
- `altB`：向后移动一个单词；
- `^U`：剪切从光标到行首的内容；
- `^K`：剪切从光标到行尾的内容；
- `^Y`：粘贴；
- `^W`：剪切光标前的一个单词；
- `↑`/`↓`：浏览命令历史；
- `^R`：反向搜索历史命令；
- `^G`：从历史搜索模式退出；

### **常见交互命令**

- `read [options] 变量名1 [变量名2 ...]`：从输入读取一行，并将该行的内容按单词分割后赋值给指定变量；

  **可用选项**

  - `-u FD`：从文件描述符中读取；
  - `-p PROMPT`：在尝试读取之前，输出提示字符串；
  - `-s`：静默模式，输入时不回显；
  - `-t TIMEOUT`：设置超时时间。

- `printf [-v var] FORMAT [arguments]` ：输出信息；

- `select`：提供简单的菜单选择功能；

- `export [options] [names[=value]]`：将 Shell 变量导出为环境变量，使其在当前 Shell 及其所有子进程中可用；

- `alias [-p] [names=[value]]`：定义命令别名，其中 `-p` 指打印所有已定义的别名；

- `more [options] [files]`：用于分屏显示输入的内容，按回车键向下翻一行，按空格键向下翻一屏，按 `q` 键退出；

- `less`：`more` 的增强版，支持向前和向后翻页，且支持搜索，按空格向下翻页，按 `b` 向上翻页，`/<str>` 向下搜索，`?<str>` 向上搜索，`q` 退出；

- `source FILENAME [arguments]`：在当前 Shell 环境中读取并执行指定文件中的命令，通常用于使修改后的配置文件立即生效；

- `变量名=值`：为变量赋值；

- `$变量名`：变量取值；

- `readonly`：只读变量；

- `unset 变量名`：删除变量（不能删除只读变量）；

- 测试变量是否为空：`[ -z "$FRUIT" ]`，测试变量是否非空：`[ -n "$FRUIT" ]`；

  > 注意测试语句的语法规范，方括号两边必须有空格，因为 Shell 需要把方括号解析为一种命令。

- `exit`：退出当前 Shell；

- `logout`：在登录的 Shell 中同样有效，功能与 `exit` 类似。

### **变量名规则**

- 变量名可以包含：字母、数字、下划线（以下划线开头的变量通常有特殊用途，一般情况下不应随便使用）；
- 变量名的第一个字符必须是字母或下划线；
- 变量名中不能包含空格或其它符号；
- 给变量赋值时，等号两边不能有空格；

### **作业控制**

- `&`：在文件名后加 `&` 代表尝试在后台运行该文件作为程序。
- `jobs`：列出当前 Shell 会话中的后台作业；
- `fg %作业号`：将后台作业切换到前台进行；
- `bg %作业号`：将已暂停的作业在后台继续进行；
- `^Z`：暂停当前正在前台进行的作业，并将其放入后台（状态为 Stopped）；
- `^C`：发送 SIGINT 信号，中断当前正在运行的前台进程；
- `^Z`：发送 SIGTSTP 信号，挂起当前前台进程，可用 `fg` 或 `bg` 命令恢复；
- `^D`：发送 EOF（文件结束符），用于退出当前 Shell 或结束输入；
- `^\`：发送 SIGQUIT 信号，强制退出进程并生成核心转储文件。

### 算数运算语法

在 Linux 中，所有的变量都默认是字符串，因此在进行运算时需要使用整数运算的语法。

- **Shell 算数运算语法**
  - `$(())`（推荐）：双括号语法，是 Bash 中进行整数算数的标准和可移植方式；
    - 示例：`c=$((a + b))`；
    - 变量名前的 `$` 在 `$(())` 内部可以省略，例如 `c=$((a + b))` 和 `c=$(($a + $b))`；
  - `$[表达式]`（旧式）：方括号语法，功能与 `$(())` 类似，但属于过时语法；
  - `let` 命令：`let c=a+b`，但 `let` 要求表达式整体不带空格；
  - `expr` 命令：`c=$(expr $a + $b)`，较繁琐，且需要空格分隔操作符。
- **支持的运算**
  - `+`（加），`-`（减），`*`（乘），`/`（除），`%`（取余），`**`（幂）等；
  - 也支持逻辑运算和位运算。
- **注意事项**
  - Shell 算术运算只支持整数，浮点运算需借助 `bc` 或 `awk` 等外部工具；
  - 在 `$(())` 内部，变量名可以不加 `$`，但空格可有可无。

> 补充：**脚本文件的 Shebang 行**
>
> 脚本文件的第一行通常以 `#!` 开头（称为 Shebang），指定用于解释该脚本的程序。文件本身必须具有执行权限才能被直接调用。

## Linux 用户关系

- **主要组（Primary Group）**：每个用户有且仅有一个主要组，在 `/etc/passwd` 文件的第四字段（GID）定义，当用户创建文件时，该文件的默认组就是这个主要组；
- **附属组（Supplementary Group）**：一个用户可以同时属于零个或多个附属组，这些组关系记录在 `/etc/group` 文件中每个组的最后一个字段（以逗号分隔的用户列表）。

## Linux 日志等级

|       等级名称       |                             说明                             |
| :------------------: | :----------------------------------------------------------: |
|   debug(LOG_DEBUG)   |                          调试级信息                          |
|    info(LOG_INFO)    |                        基本的通知信息                        |
|  notice(LOG_NOTICE)  |                 普通信息，但是有一定的重要性                 |
| warning(LOG_WARNING) |          警告信息，但是还不会影响到服务或系统的运行          |
|     err(LOG_ERR)     | 错误信息，一般达到 err 等级的信息已经可以影响到服务或系统的运行了 |
|    crit(LOG_CRIT)    |                         临界状况信息                         |
|   alert(LOG_ALERT)   |                  状态信息，必须立即采取行动                  |
|   emerg(LOG_EMERG)   |               疼痛等级信息，系统已经无法使用了               |
|          *           | 代表所有日志等级。比如，“authpriv.*”代表 authpriv 认证信息服务产生的日志中所有的日志等级。 |

## Linux 内核版本号规则

内核版本号格式为：`主版本.次版本.修订版本`

需关注**次版本号**：

- **次版本号为偶数**：该内核是一个稳定版（或长期支持版），适合用于生产环境；
- **次版本号为奇数**：该内核是一个开发版（或测试版），包含新特性但可能不稳定，适合开发者和测试者使用。

有时还会有**额外标识**：

`-rc` 候选版本、`-stable` 稳定版、`-git` 每日快照。

> 以上是传统规则，现代命名中已经逐渐淡化，不再严格遵循，实际过程中应该重点关注时间线、是否明确 LTS 版本、发行版提供的内核。

## Linux 软件包

### 包类型

- **源码包（Source Package）**
  - 包含程序的原始代码（如 `.c`，`.h`，`Makefile` 等）；
  - 需要用户在目标系统上手动编译后才能安装使用；
  - 优点：可针对特定硬件平台优化，可自定义编译选项，便于学习和修改；
  - 缺点：安装过程相对复杂、耗时，且需要编译环境；
  - 常见形式：`.tar.gz`，`.tar.bz2`，`.src.rpm`（SRPM）。
- **二进制包（Binary Package）**
  - 包含已经编译好、可直接执行的程序文件以及配置文件、文档等；
  - 用户无需编译，直接通过包管理器（如 `rpm`，`dpkg`）安装即可使用；
  - 优点：安装快速、简单，易于管理和卸载（依赖关系管理）;
  - 缺点：可能不是针对特定 CPU 最优化的，不能修改编译参数；
  - 常见形式：`.rpm`（Red Hat/Fedora/CentOS），`.deb`（Debian/Ubuntu）。

### 包管理操作

使用 RPM（Red Hat Package Manager）包管理器进行包管理操作。

> 包管理器的大致分类：
>
> **RPM 系**：`rpm`（低级），`yum/dnf`（高级）；
>
> **Debian 系**：`dpkg`（低级），`apt/apt-get`（高级）。
>
> 这里只介绍 RPM 是因为考试仅涉及到了 RPM 的用法。

**可用选项**

- `-ql <package_name>`：查询（query）并列出（list）该软件包安装到系统的所有文件的完整路径；
- `-qa`：列出所有已安装的包；
- `-qf <file_path>`：查询指定文件（file）属于的包；
- `-qp <package.rpm>`：查询一个未安装的 RPM 文件的信息；
- `-qc <package_name>`：查询包的配置文件列表
- `-ivh <package.rpm>`：安装指定的包；
- `-e <package_name>`：卸载（erase）指定的包；
- `-Uvh <package.rpm>`：升级指定的包。

## Linux 日志管理方法

Linux 中负责收集、处理和记录日志的标准系统服务是 `rsyslogd`。

- **功能**：负责从各种来源（内核、应用程序、其它服务）接收日志消息，并根据配置规则将它们过滤、格式化，然后写入到不同的日志文件中（如 `/var/log/messages`、`/var/log/secure`），或转发到其它服务器；
- **特点**：高性能、支持多种输入输出模块，支持 TCP 和 UDP、支持 TLS 加密、支持数据库存储等；
- **配置文件**：主配置文件 `/etc/rsyslog.conf`，以及 `/etc/rsyslog.d/` 子目录下的附加配置文件。

## 拓展 -  虚拟化软件使用的虚拟网卡

虚拟机通常使用以下三种类型的虚拟网卡：

- **桥接（Bridged）**：虚拟网卡直接连接到物理主机的物理网卡上，与物理主机在同一个局域网中，虚拟主机将与物理主机处在同一网段上，IP地址由同一 DHCP 服务器分发；
- **NAT**：虚拟机通过物理主机的网络地址转换（NAT）功能访问外网，虚拟机和物理主机通常不在同一网段（它们共用一个虚拟交换机，物理主机作为网关）；
- **仅主机（Host-Only）**：虚拟机只能与物理主机以及同一仅主机网络内的其它虚拟机通信，无法访问外网。